:py:mod:`pangeo_fish.hmm.estimator.split`
=========================================

.. py:module:: pangeo_fish.hmm.estimator.split


Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   pangeo_fish.hmm.estimator.split.EagerScoreEstimator




.. py:class:: EagerScoreEstimator


   Estimator to train and predict gaussian random walk hidden markov models

   Parameters
   ----------
   sigma : float, default: None
       The primary model parameter: the standard deviation of the distance
       per time unit traveled by the fish, in the same unit as the grid coordinates.
   truncate : float, default: 4.0
       The cut-off limit of the filter. This can be used, together with `sigma`, to
       calculate the maximum distance per time unit traveled by the fish.

   .. py:attribute:: sigma
      :type: float

      

   .. py:attribute:: truncate
      :type: float
      :value: 4.0

      

   .. py:method:: to_dict()


   .. py:method:: set_params(**params)

      set the parameters on a new instance

      Parameters
      ----------
      **params
          Mapping of parameter name to new value.


   .. py:method:: _score(X, *, spatial_dims=None, temporal_dims=None)


   .. py:method:: _forward_algorithm(X, *, spatial_dims=None, temporal_dims=None)


   .. py:method:: _backward_algorithm(X, *, spatial_dims=None, temporal_dims=None)


   .. py:method:: _forward_backward_algorithm(X, *, spatial_dims=None, temporal_dims=None)


   .. py:method:: predict_proba(X, *, spatial_dims=None, temporal_dims=None)

      predict the state probabilities

      This is done by applying the forward-backward algorithm to the data.

      Parameters
      ----------
      X : Dataset
          The emission probability maps. The dataset should contain these variables:
          - `initial`, the initial probability map
          - `final`, the final probability map
          - `pdf`, the emission probabilities
          - `mask`, a mask to select ocean pixels
      spatial_dims : list of hashable, optional
          The spatial dimensions of the dataset.
      temporal_dims : list of hashable, optional
          The temporal dimensions of the dataset.

      Returns
      -------
      state_probabilities : DataArray
          The computed state probabilities


   .. py:method:: score(X, *, spatial_dims=None, temporal_dims=None)

      score the fit of the selected model to the data

      Apply the forward-backward algorithm to the given data, then return the
      negative logarithm of the normalization factors.

      Parameters
      ----------
      X : Dataset
          The emission probability maps. The dataset should contain these variables:
          - `pdf`, the emission probabilities
          - `mask`, a mask to select ocean pixels
          - `initial`, the initial probability map
          - `final`, the final probability map (optional)
      spatial_dims : list of hashable, optional
          The spatial dimensions of the dataset.
      temporal_dims : list of hashable, optional
          The temporal dimensions of the dataset.

      Return
      ------
      score : float
          The score for the fit with the current parameters.


   .. py:method:: decode(X, *, mode='viterbi', spatial_dims=None, temporal_dims=None, is_states=False)

      decode the state sequence from the selected model and the data

      Parameters
      ----------
      X : Dataset
          The emission probability maps. The dataset should contain these variables:
          - `pdf`, the emission probabilities
          - `mask`, a mask to select ocean pixels
          - `initial`, the initial probability map
          - `final`, the final probability map (optional)
      mode : {"mean", "mode", "viterbi"}, default: "viterbi"
          The decoding method. Can be one of
          - ``"mean"``: use the centroid of the state probabilities as decoded state
          - ``"mode"``: use the maximum of the state probabilities as decoded state
          - ``"viterbi"``: use the viterbi algorithm to determine the most probable states
      spatial_dims : list of hashable, optional
          The spatial dimensions of the dataset.
      temporal_dims : list of hashable, optional
          The temporal dimensions of the dataset.
      is_states : bool, default: False
          Whether ``X`` is the precomputed state probabilities. Useful if computing both
          the mean and mode states.



